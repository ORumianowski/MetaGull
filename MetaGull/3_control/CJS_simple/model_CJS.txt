
model {

  phi ~ dunif(0, 1) # Prior for mean survival
  p ~ dunif(0, 1) # Prior for mean recapture

  # Likelihood
  for (i in 1:nind) {
    # Define latent state at first capture
    z[i, f[i]] <- 1
    
    for (t in (f[i] + 1):n.occasions) {
      # State process
        z[i, t] ~ dbern(mu1[i, t])
        mu1[i, t] <- phi* z[i, t-1]
        
      # Observation process
       y[i, t] ~ dbern(mu2[i, t])
       mu2[i, t] <- p * z[i, t]
       
    } #t
  } #i
}
